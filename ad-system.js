// ===============================
// Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ©
// ===============================

// --- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© (50+ Ø±Ø§Ø¨Ø·) ---
const adLinks = [
    "https://www.effectivegatecpm.com/f24em5wax?key=ee9cb9ab641e0b2bc42940c78a430941",
    "https://www.effectivegatecpm.com/k0u3xu0g?key=de0b3472101490d0833afec7d5bc4ae2",
    "https://www.effectivegatecpm.com/w7z02fjr0?key=486bf5928bcb6905cfb8cc1f8e97e000",
    "https://www.effectivegatecpm.com/bubqyea02?key=9b31f92476bbb89c9a2be9574e47df53",
    "https://www.effectivegatecpm.com/w83ueqruku?key=32ed759e30d058d87b7d1862873fd70d",
    "https://www.effectivegatecpm.com/f1pn2zd4j?key=d90bef8a2ee25e4f23c3cb7fe4f6fd4b",
    "https://www.effectivegatecpm.com/mchbwege?key=41787e1ea924cfb770e6f7369f95b1c5",
    "https://www.effectivegatecpm.com/tgs5fxit68?key=ac854a9817601d323747645be7364bb4",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/ydjrk5i8?key=f65d0dfc4bbbf9de84c8d3e5d3f096af",
    "https://www.effectivegatecpm.com/f7pxzt00y?key=846c88991d57c3a0d04b02a4ba515188",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce",
    "https://www.effectivegatecpm.com/mqiirgxcu?key=1c2da9371ca4e68c42cee239b72a88ce"
];

// --- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© (20 Ø±Ø³Ø§Ù„Ø©) ---
const popupMessages = [
    "Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù‡ÙŠ Ù…ØµØ¯Ø± Ø¯Ø¹Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ â¤ï¸",
    "Ø¨ÙØ¶Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙŠØ¨Ù‚Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ø¬Ø§Ù†ÙŠ Ø¯Ø§Ø¦Ù…Ù‹Ø§ ğŸŒŸ",
    "Ø´ÙƒØ±Ù‹Ø§ Ù„ØªÙÙ‡Ù…Ùƒ ÙˆØ¯Ø¹Ù…Ùƒ Ø§Ù„Ù…Ø³ØªÙ…Ø± ğŸ™",
    "ÙƒÙ„ Ø¥Ø¹Ù„Ø§Ù† ÙŠØ³Ø§Ø¹Ø¯Ù†Ø§ ÙÙŠ ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø®Ø¯Ù…Ø© âœ¨",
    "Ù†Ø­Ù† Ù†Ù‚Ø¯Ø± ÙˆÙ‚ØªÙƒ ÙˆØ¯Ø¹Ù…Ùƒ Ù„Ù†Ø§ ğŸ’™",
    "Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØªØ³Ø§Ø¹Ø¯Ù†Ø§ ÙÙŠ ØªÙ‚Ø¯ÙŠÙ… Ù…Ø­ØªÙˆÙ‰ Ø£ÙØ¶Ù„ ğŸ¬",
    "Ø´ÙƒØ±Ù‹Ø§ Ù„Ùƒ! Ø£Ù†Øª ØªØ³Ø§Ù‡Ù… ÙÙŠ Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ğŸŒ¸",
    "Ø¥Ø¹Ù„Ø§Ù† ÙˆØ§Ø­Ø¯ = Ø¯Ø¹Ù… ÙƒØ¨ÙŠØ± Ù„Ù„Ù…ÙˆÙ‚Ø¹ ğŸ’ª",
    "ØªÙÙ‡Ù…Ùƒ ÙŠØ¹Ù†ÙŠ Ù„Ù†Ø§ Ø§Ù„ÙƒØ«ÙŠØ±ØŒ Ø´ÙƒØ±Ù‹Ø§ ğŸŒº",
    "Ù…Ø¹Ù‹Ø§ Ù†Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ø¬Ø§Ù†ÙŠÙ‹Ø§ ğŸ¤",
    "Ø¯Ø¹Ù…Ùƒ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙŠÙ‡Ù…Ù†Ø§ ğŸ’–",
    "Ù†Ø´ÙƒØ±Ùƒ Ø¹Ù„Ù‰ ØµØ¨Ø±Ùƒ ÙˆØ¯Ø¹Ù…Ùƒ ğŸ­",
    "Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØªØ¨Ù‚ÙŠ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù…ØªØ§Ø­Ù‹Ø§ Ù„Ù„Ø¬Ù…ÙŠØ¹ ğŸŒ",
    "Ø£Ù†Øª Ø¬Ø²Ø¡ Ù…Ù† Ù†Ø¬Ø§Ø­ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŒ Ø´ÙƒØ±Ù‹Ø§ ğŸ†",
    "ÙƒÙ„ Ù…Ø´Ø§Ù‡Ø¯Ø© Ø¥Ø¹Ù„Ø§Ù† = Ø®Ø¯Ù…Ø© Ø£ÙØ¶Ù„ Ù„Ùƒ ğŸ¯",
    "Ø´ÙƒØ±Ù‹Ø§ Ù„Ù…Ø³Ø§Ù‡Ù…ØªÙƒ ÙÙŠ Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ù…ÙˆÙ‚Ø¹ ğŸŒˆ",
    "Ø¨Ø¯Ø¹Ù…Ùƒ Ù†Ø³ØªÙ…Ø± ÙÙŠ ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø£ÙØ¶Ù„ ğŸª",
    "Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù‚ØµÙŠØ±Ø©ØŒ Ù„ÙƒÙ† ÙØ§Ø¦Ø¯ØªÙ‡Ø§ ÙƒØ¨ÙŠØ±Ø© ğŸ’«",
    "Ù†Ù‚Ø¯Ù‘Ø± ØªØ¹Ø§ÙˆÙ†Ùƒ ÙˆØ¯Ø¹Ù…Ùƒ Ù„Ù…ÙˆÙ‚Ø¹Ù†Ø§ ğŸ¨",
    "Ù…Ø¹Ù‹Ø§ Ù†ØµÙ†Ø¹ ØªØ¬Ø±Ø¨Ø© Ù…Ø´Ø§Ù‡Ø¯Ø© Ø±Ø§Ø¦Ø¹Ø© ğŸ‰"
];

// --- Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ---
let currentAdIndex = 0; // Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
let lastAdTime = 0; // Ø¢Ø®Ø± ÙˆÙ‚Øª ØªÙ… ÙØªØ­ Ø¥Ø¹Ù„Ø§Ù† ÙÙŠÙ‡
const AD_COOLDOWN = 60000; // Ù…Ø¯Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø¨ÙŠÙ† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª (1 Ø¯Ù‚ÙŠÙ‚Ø© = 60000 Ù…ÙŠÙ„ÙŠ Ø«Ø§Ù†ÙŠØ©)

// --- Ø­ÙØ¸ ÙˆØ§Ø³ØªØ¹Ø§Ø¯Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù… ---
function saveAdSystemState() {
    localStorage.setItem('currentAdIndex', currentAdIndex);
    localStorage.setItem('lastAdTime', lastAdTime);
}

function loadAdSystemState() {
    const savedIndex = localStorage.getItem('currentAdIndex');
    const savedTime = localStorage.getItem('lastAdTime');
    
    if (savedIndex !== null) {
        currentAdIndex = parseInt(savedIndex);
    }
    
    if (savedTime !== null) {
        lastAdTime = parseInt(savedTime);
    }
}

// --- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ---
function canShowAd() {
    const currentTime = Date.now();
    const timeSinceLastAd = currentTime - lastAdTime;
    
    // Ø¥Ø°Ø§ Ù…Ø±Øª Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø© Ù…Ù†Ø° Ø¢Ø®Ø± Ø¥Ø¹Ù„Ø§Ù†ØŒ Ø§Ø³Ù…Ø­ Ø¨Ø¹Ø±Ø¶ Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯
    return timeSinceLastAd >= AD_COOLDOWN || lastAdTime === 0;
}

// --- ÙØªØ­ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ---
function openAdLink() {
    if (!canShowAd()) {
        console.log('ÙŠØ¬Ø¨ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø© Ù‚Ø¨Ù„ Ø¹Ø±Ø¶ Ø¥Ø¹Ù„Ø§Ù† Ø¢Ø®Ø±');
        return false;
    }
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø­Ø§Ù„ÙŠ
    const adUrl = adLinks[currentAdIndex % adLinks.length];
    
    // ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ ØµÙØ­Ø© Ø¬Ø¯ÙŠØ¯Ø©
    window.open(adUrl, '_blank');
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯ ÙˆØ§Ù„ÙˆÙ‚Øª
    currentAdIndex++;
    lastAdTime = Date.now();
    
    // Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø©
    saveAdSystemState();
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
    setTimeout(showPopupMessage, 2000);
    
    return true;
}

// --- Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ---
function showPopupMessage() {
    // Ø§Ø®ØªÙŠØ§Ø± Ø±Ø³Ø§Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
    const randomIndex = Math.floor(Math.random() * popupMessages.length);
    const message = popupMessages[randomIndex];
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
    const popup = document.createElement('div');
    popup.className = 'ad-popup-overlay';
    popup.innerHTML = `
        <div class="ad-popup-content">
            <div class="ad-popup-icon">
                <i class="fas fa-heart"></i>
            </div>
            <h3 class="ad-popup-title">Ø´ÙƒØ±Ù‹Ø§ Ù„Ø¯Ø¹Ù…Ùƒ</h3>
            <p class="ad-popup-message">${message}</p>
            <button class="ad-popup-close" onclick="closeAdPopup()">
                <i class="fas fa-check"></i>
                Ø­Ø³Ù†Ù‹Ø§ØŒ ÙÙ‡Ù…Øª
            </button>
        </div>
    `;
    
    document.body.appendChild(popup);
    
    // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¸Ù‡ÙˆØ±
    setTimeout(() => {
        popup.classList.add('active');
    }, 10);
}

// --- Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ---
function closeAdPopup() {
    const popup = document.querySelector('.ad-popup-overlay');
    if (popup) {
        popup.classList.remove('active');
        setTimeout(() => {
            popup.remove();
        }, 400);
    }
}

// --- Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø©: ØªÙ†ÙÙŠØ° Ø¥Ø¹Ù„Ø§Ù† Ù‚Ø¨Ù„ ÙˆØ¸ÙŠÙØ© ---
function executeWithAd(originalFunction, ...args) {
    if (canShowAd()) {
        // ÙØªØ­ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø£ÙˆÙ„Ø§Ù‹
        openAdLink();
        
        // ØªÙ†ÙÙŠØ° Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø©
        setTimeout(() => {
            originalFunction(...args);
        }, 1000);
    } else {
        // ØªÙ†ÙÙŠØ° Ø§Ù„ÙˆØ¸ÙŠÙØ© Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¯ÙˆÙ† Ø¥Ø¹Ù„Ø§Ù†
        originalFunction(...args);
    }
}

// --- ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ---
function initAdSystem() {
    loadAdSystemState();
    console.log('âœ… ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª');
}

// --- ØªØµØ¯ÙŠØ± Ø§Ù„Ø¯ÙˆØ§Ù„ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ø§Ù… ---
window.adSystem = {
    canShowAd,
    openAdLink,
    executeWithAd,
    showPopupMessage,
    closeAdPopup
};

// --- ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ---
document.addEventListener('DOMContentLoaded', initAdSystem);
